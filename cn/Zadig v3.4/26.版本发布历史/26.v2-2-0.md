---
title: v2.2.0 Release Notes
date: 2023-12-11 16:06:07
permalink: /cn/Zadig v3.4/release-notes/v2.2.0/
---

2024 年 2 月 25 日，Zadig 正式发布 v2.2.0 版本。

## 功能列表
**新功能**
- 基础组件全面支持多副本部署
- K8s YAML 项目版本管理支持手动创建版本
- K8s Helm Chart 项目支持测试环境 Chart 实例化部署
- 自定义工作流部署和镜像分发任务支持选择版本
- 自定义工作流支持主机部署场景
- 自定义工作流部署任务支持按输入顺序执行
- 自定义工作流支持对象存储缓存
- 代码扫描、测试支持配置执行并发数量
- Windows 构建支持 powershell 脚本 
- 发布计划支持选择版本
- 模板库新增代码扫描模板
- OpenAPI 添加新增环境、服务、项目权限和用户等 

**其他修复及优化**
- 用户及权限相关接口安全增强
- 主机项目服务配置交互优化
- 系统公告展示页优化
- 自定义工作流蓝绿发布任务资源清理逻辑优化
- 修复 Cron 服务在某些场景下 panic 问题
- 产品工作流下线，数据自动迁移至自定义工作流


## 业务变更声明

1. 产品工作流下线，原产品工作流数据自动迁移至自定义工作流，因工作流引擎改变，部分功能有所调整，具体如下：
    - 原产品工作流 Jenkins 构建功能下线，后续在自定义工作流中支持
    - 原产品工作流 webhook 触发器中更新策略`动态选择空闲环境更新`和`设定指定环境为基准环境`功能下线，后续在自定义工作流中支持
    - 原产品工作流镜像回滚功能暂时下线，后续在自定义工作流中支持
    - 若原产品工作流中未指定环境，升级后自动会选择一个环境填入
    - k8s yaml 项目创建版本和版本发布功能变更，具体参考[文档](/cn/Zadig%20v2.2.0/project/version/)
    - 系统内置变量调整，可以通过调整配置和脚本，使用自定义工作流变量传递能力获得对应变量
        - 测试
            - 下线变量： `LINKED_ENV`、`ENV_NAME`、`SERVICES`
            - 修改变量：`TEST_URL` 改为 `TASK_URL`
        - 构建
            - 下线变量：`DIST_DIR`、`ENV_NAME`
            - 修改变量：`BUILD_URL`  改为 `TASK_URL`
    - 迁移后的新工作流统一在`所有`视图中
::: warning
若原产品工作流自身无法正常执行，该工作流则不会自动迁移至自定义工作流
:::
  

2. 主机接入方式调整，v2.2.0 版本中同一台主机仅支持一种接入方式，如果升级前配置了 SSH 和 agent 两种方式，升级后系统自动保留 SSH 配置，Agent 方式需在升级后重新接入。
3. 主机项目部署配置调整，不再支持和构建步骤共享工作空间，若存在部署任务使用构建任务工作空间中的文件，升级后需调整配置


## 版本升级过程

::: danger
因产品工作流配置存在特异性，存在数据升级失败风险，强烈建议产品工作流自行迁移至自定义工作流。
:::

::: warning
若使用的 MongoDB 版本 > 4.0, 且以 Replica Set 模式部署，请确认未使用 admin/local/config/test 等系统库作为 Zadig 的业务库；如有使用，请先手动迁移数据。
如果当前系统版本 < v2.1.0，请先升级到 v2.1.0，具体升级过程参见 [v2.1.0 升级方式](/cn/Zadig%20v2.2.0/release-notes/v2.1.0/#版本升级过程)，再按照以下方式升级到 v2.2.0
:::


请根据不同的安装方式执行对应的升级过程：

- 使用脚本命令安装：升级参考[文档](/cn/Zadig%20v2.2.0/install/helm-deploy/#升级)
- 使用 Helm 命令安装：升级参考[文档](/cn/Zadig%20v2.2.0/install/helm-deploy/#升级)
- 官方通道安装：升级参考[文档](/cn/Zadig%20v2.2.0/stable/install/#升级)
